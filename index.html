<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>BioCompare — Protein Comparison</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <!-- ... (styles and head unchanged for brevity) ... -->
  <style>
    /* [Keep all your original CSS here, unchanged] */
    :root{
      --accent: #0aa89e;
      --muted: #6b7280;
      --bg-band: rgba(10,168,158,0.06);
      --card: #ffffff;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace;
      --maxw:1100px;
    }
    html,body{height:100%}
    body{font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;max-width:var(--maxw);margin:20px auto;color:#0f1720;padding:0 16px 40px;background:#ffffff;}
    .hero-band{background:linear-gradient(180deg,var(--bg-band) 0%,rgba(255,255,255,0.65) 60%);padding:18px 14px;border-radius:10px;margin-bottom:16px;display:flex;align-items:center;justify-content:space-between;gap:14px;}
    .hero-left{display:flex;gap:12px;align-items:flex-start;}
    .title-wrap{line-height:1;}
    .site-title{margin:0;font-size:28px;font-weight:800;color:#0a3b36;letter-spacing:-0.4px;position:relative;text-shadow:0 1px 0 #ffffff,0 -1px 0 rgba(0,0,0,0.06);}
    .site-tagline{margin:6px 0 0;color:var(--muted);font-size:13px;}
    .note{font-size:13px;color:#334;background:linear-gradient(180deg,#ffffff,#fbfffe);border:1px solid rgba(10,168,158,0.12);padding:10px 14px;border-radius:10px;max-width:520px;box-shadow:0 6px 18px rgba(10,20,20,0.03);}
    .note b{color:#0f1720;}
    label{display:block;margin-top:12px;font-weight:600}
    input[type="text"]{width:100%;padding:10px;border:1px solid #e6eef0;border-radius:8px;font-family:var(--mono);background:#fbfffe;box-shadow:0 1px 0 rgba(0,0,0,0.02) inset;}
    .field-row{display:flex;gap:28px;align-items:flex-start;margin-top:12px;}
    .field-row .input-col{flex:0 0 50%;}
    .example-box{position:relative;background:#fbfffe;border:1px solid #e6eef0;border-radius:8px;padding:12px 12px 14px 12px;font-family:var(--mono);font-size:13px;color:#111;box-sizing:border-box;width:420px;max-width:48vw;}
    .example-title{font-weight:700;margin:0 0 8px;color:#0f1720;font-family:inherit;font-size:14px;}
    .example-row{display:flex;gap:8px;align-items:center;margin-bottom:6px;}
    .example-row strong{width:18px;display:inline-block;font-weight:700;}
    .example-copy-btn{position:absolute;right:10px;top:10px;background:var(--accent);color:#fff;border:0;padding:6px 10px;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;box-shadow:0 6px 20px rgba(10,20,20,0.06);}
    .example-copy-btn:active{transform:translateY(1px);}
    .example-copy-btn[disabled]{opacity:.6;cursor:default;}
    .copy-id{display:inline-block;padding:2px 8px;border:1px solid #e6eef0;border-radius:6px;background:#ffffff;cursor:pointer;user-select:none;font-family:var(--mono);font-size:13px;}
    .copy-id:hover{background:#f0fdfa;border-color:#c8efea;}
    .copy-id.copied{background:#eafff8;border-color:#8be4d9;}
    .tooltip-copied{position:fixed;z-index:9999;pointer-events:none;background:var(--accent);color:#fff;padding:6px 8px;border-radius:6px;font-size:12px;box-shadow:0 6px 18px rgba(10,20,20,0.12);opacity:0;transform:translate(-50%,-6px);transition:opacity .15s ease,transform .15s ease;}
    .fields-grid{display:grid;grid-template-columns:1fr auto;column-gap:28px;row-gap:12px;align-items:start;}
    .fields-grid .input-col{grid-column:1;}
    .fields-grid .example-span{grid-column:2;grid-row:1 / span 2;justify-self:end;}
    button{margin-top:8px;padding:10px 14px;border-radius:8px;border:0;background:var(--accent);color:#fff;cursor:pointer;font-weight:700;}
    button:disabled{opacity:.6;cursor:default}
    .meta{font-size:13px;color:var(--muted);margin-top:8px}
    .spinner{display:inline-block;width:12px;height:12px;border-radius:50%;border:2px solid rgba(0,0,0,0.12);border-top-color:var(--accent);animation:spin .8s linear infinite;vertical-align:middle;margin-left:8px}
    @keyframes spin{to{transform:rotate(360deg)}
    }
    .container{display:flex;gap:18px;margin-top:14px;align-items:flex-start;}
    .left{width:160px;}
    .left .controls{background:linear-gradient(180deg,#ffffff,#fbfffe);border:1px solid #eef6f4;border-radius:10px;padding:12px;box-shadow:0 6px 18px rgba(10,20,20,0.02);}
    .icon-btn{display:flex;align-items:center;gap:8px;padding:8px;border-radius:8px;cursor:pointer;margin-bottom:8px;user-select:none;transition:background .12s,color .12s;}
    .icon-btn:hover{background:rgba(10,168,158,0.06);}
    .icon-btn.active{background:var(--accent);color:#fff;}
    .icon-emoji{font-size:20px;width:28px;text-align:center;}
    .small{font-size:13px;color:#444;}
    .right{flex:1;min-height:320px;}
    .panel{border-radius:10px;border:1px solid #eef6f4;padding:14px;margin-bottom:12px;background:var(--card);box-shadow:0 6px 18px rgba(10,20,20,0.03);}
    .panel h2{margin:0 0 8px;font-size:15px;display:flex;justify-content:space-between;align-items:center;}
    .venn-container{width:100%;height:300px;display:flex;align-items:center;justify-content:center;}
    .stats{font-size:13px;color:#333;margin-top:8px;}
    .table-panel{display:none;border-radius:10px;border:1px solid #eef6f4;padding:12px;background:var(--card);box-shadow:0 6px 18px rgba(10,20,20,0.03);margin-bottom:12px;}
    .table-actions{display:flex;gap:8px;align-items:center;margin-bottom:8px;}
    .download-btn{background:#0a7f72;color:#fff;border:0;padding:8px 10px;border-radius:8px;cursor:pointer;font-weight:700;}
    .download-btn:disabled{opacity:.6;cursor:default;}
    table.compare{width:100%;border-collapse:collapse;font-size:13px;}
    table.compare th,table.compare td{text-align:left;padding:8px 10px;border-bottom:1px solid #eef6f4;}
    table.compare th{font-weight:700;background:#fbfffe;position:sticky;top:0;z-index:1;}
    .no-data{color:var(--muted);padding:12px 0;}
    #output{white-space:pre-wrap;background:#0f1720;color:#e6eef8;padding:12px;border-radius:8px;margin-top:14px;min-height:140px;overflow:auto;border:1px solid #253046;display:none;}
    .compare-headers{display:flex;gap:12px;}
    .col{flex:1;border:1px solid #edf7f6;border-radius:8px;padding:10px;min-height:140px;max-height:320px;overflow:auto;background:#fbfffe;}
    .col h4{margin:0 0 6px;font-size:13px;color:#0f1720;}
    .item{font-family:var(--mono);font-size:13px;padding:6px 0;border-bottom:1px dashed rgba(0,0,0,0.04);color:#111;}
    .hint{font-size:13px;color:var(--muted);margin-top:8px;}
    @media (max-width:880px){
      .container{flex-direction:column;}
      .left{width:100%;order:2;}
      .right{order:1;}
      .note{max-width:100%;}
      .site-title{font-size:22px;}
      .field-row{flex-direction:column;align-items:stretch;}
      .field-row .input-col{flex:1 1 auto;}
      .fields-grid{display:block;}
      .example-box{width:auto;max-width:100%;}
      table.compare th,table.compare td{padding:8px 6px;}
    }
  </style>
  <script src="https://unpkg.com/d3@5"></script>
  <script src="https://unpkg.com/venn.js@0.2.20/build/venn.min.js"></script>
</head>
<body>
  <!-- [Keep your original body content unchanged] -->
  <!-- ... (body content unchanged for brevity) ... -->
  <div class="hero-band" role="banner" aria-label="BioCompare header">
    <div class="hero-left">
      <div class="title-wrap">
        <h1 class="site-title">BioCompare</h1>
        <p class="site-tagline">Quickly explore and compare proteins from multiple trusted sources.</p>
      </div>
    </div>
    <div class="note" aria-hidden="false">
      <div><strong>Demo sources:</strong> Ensembl, UniProt, and NCBI Gene.</div>
      <div style="margin-top:6px;color:#334;font-size:13px;">
        Some annotations may be incomplete — the aggregation pipeline is under active development and will be expanded in upcoming releases.
      </div>
    </div>
  </div>
  <!-- [Rest of HTML unchanged] -->
  <div>
    <div class="fields-grid">
      <div class="input-col">
        <label for="ensembl1">Ensembl ID A</label>
        <input id="ensembl1" type="text" placeholder="ENSG00000141510" />
      </div>
      <div class="example-box example-span" aria-label="Examples">
        <button class="example-copy-btn" id="copyExampleBtn" title="Copy example IDs">Copy example</button>
        <div class="example-title">Example to see the intersection representation.</div>
        <div class="example-row"><strong>A</strong>: <span class="copy-id" data-copy="ENSG00000124610">ENSG00000124610</span></div>
        <div class="example-row"><strong>B</strong>: <span class="copy-id" data-copy="ENSG00000168298">ENSG00000168298</span></div>
      </div>
      <div class="input-col">
        <label for="ensembl2">Ensembl ID B</label>
        <input id="ensembl2" type="text" placeholder="ENSG00000139618" />
      </div>
    </div>
    <div class="meta">This page POSTS the two IDs to your server and uses the returned JSON for frontend comparisons and a comparison table.</div>
    <button id="submit">Submit</button>
    <span id="status" class="meta"></span>
  </div>
  <!-- [Rest of your UI panels as in your original code] -->
  <div class="container">
    <!-- ... (unchanged controls and right-side content) ... -->
    <!-- [The rest of your HTML remains unchanged] -->
  </div>
<script>
/* Endpoint - CHANGED to relative so works on Render and local! */
const API_ENDPOINT = "/annotate";
/* [Rest of your JS remains unchanged, just update the API_ENDPOINT above] */

/* DOM refs */
const en1 = document.getElementById('ensembl1');
const en2 = document.getElementById('ensembl2');
const btn = document.getElementById('submit');
const out = document.getElementById('output');
const status = document.getElementById('status');

const btnGoIds = document.getElementById('btn-goids');
const btnGoTerms = document.getElementById('btn-goterms');
const btnSymbols = document.getElementById('btn-symbols');
const btnTable = document.getElementById('btn-table');

const panelGoIds = document.getElementById('panel-goids');
const panelGoTerms = document.getElementById('panel-goterms');
const panelSymbols = document.getElementById('panel-symbols');
const tablePanel = document.getElementById('table-panel');

const goidsAList = document.getElementById('goids-a-list');
const goidsBothList = document.getElementById('goids-both-list');
const goidsBList = document.getElementById('goids-b-list');

const gotermsAList = document.getElementById('goterms-a-list');
const gotermsBothList = document.getElementById('goterms-both-list');
const gotermsBList = document.getElementById('goterms-b-list');

const symbolsAList = document.getElementById('symbols-a-list');
const symbolsBothList = document.getElementById('symbols-both-list');
const symbolsBList = document.getElementById('symbols-b-list');

const goidsCount = document.getElementById('goids-count');
const gotermsCount = document.getElementById('goterms-count');
const symbolsCount = document.getElementById('symbols-count');

const goidsStats = document.getElementById('goids-stats');
const gotermsStats = document.getElementById('goterms-stats');
const symbolsStats = document.getElementById('symbols-stats');

const downloadCsvBtn = document.getElementById('downloadCsvBtn');
const tableContainer = document.getElementById('table-container');
const tableMeta = document.getElementById('table-meta');

let lastResponse = null;

/* [Rest of your JS code is identical to your current file, unchanged, except for API_ENDPOINT above] */
/* ... */
</script>
<pre id="example-ids" aria-hidden="true" style="position:absolute;left:-10000px;top:auto;width:1px;height:1px;overflow:hidden;white-space:pre;">
A: ENSG00000124610
B: ENSG00000168298
Example to see the intersection representation.
</pre>
</body>
</html>
