<!doctype html> <html> <head> <meta charset="utf-8" /> <title>BioCompare â€” Protein Comparison</title> <meta name="viewport" content="width=device-width,initial-scale=1" /> <style> :root{ --accent: #0aa89e; /* teal accent requested */ --muted: #6b7280; --bg-band: rgba(10,168,158,0.06); /* very faint teal band */ --card: #ffffff; --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace; --maxw:1100px; } /* Page base */ html,body{height:100%} body{ font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; max-width:var(--maxw); margin:20px auto; color:#0f1720; padding:0 16px 40px; background:#ffffff; } /* HERO: off-white band behind hero */ .hero-band { background: linear-gradient(180deg, var(--bg-band) 0%, rgba(255,255,255,0.65) 60%); padding:18px 14px; border-radius:10px; margin-bottom:16px; display:flex; align-items:center; justify-content:space-between; gap:14px; } .hero-left { display:flex; gap:12px; align-items:flex-start; } .title-wrap { line-height:1; } .site-title { margin:0; font-size:28px; /* larger title */ font-weight:800; color:#0a3b36; /* darker teal-ish for text */ letter-spacing:-0.4px; position:relative; /* soft embossed / inset look (subtle inner-shadow feel) */ text-shadow: 0 1px 0 #ffffff, /* light top */ 0 -1px 0 rgba(0,0,0,0.06); /* faint inner dark line */ } .site-tagline { margin:6px 0 0; color:var(--muted); font-size:13px; } /* subtle note box on the right of hero */ .note { font-size:13px; color:#334; background: linear-gradient(180deg, #ffffff, #fbfffe); border:1px solid rgba(10,168,158,0.12); padding:10px 14px; border-radius:10px; max-width:520px; box-shadow: 0 6px 18px rgba(10,20,20,0.03); } .note b { color:#0f1720; } /* inputs and controls */ label{display:block;margin-top:12px;font-weight:600} input[type="text"]{ width:100%; padding:10px; border:1px solid #e6eef0; border-radius:8px; font-family:var(--mono); background: #fbfffe; box-shadow: 0 1px 0 rgba(0,0,0,0.02) inset; } .field-row { display:flex; gap:28px; align-items:flex-start; margin-top:12px; } .field-row .input-col { flex:0 0 50%; } .field-row .example-box { flex:0 0 50%; background:#fbfffe; border:1px solid #e6eef0; border-radius:8px; padding:10px; font-family:var(--mono); font-size:13px; color:#111; box-sizing:border-box; } .copy-id { display:inline-block; padding:2px 8px; border:1px solid #e6eef0; border-radius:6px; background:#ffffff; cursor:pointer; user-select:none; } .copy-id:hover { background:#f0fdfa; border-color:#c8efea; } .copy-id.copied { background:#eafff8; border-color:#8be4d9; } .tooltip-copied { position:fixed; z-index:9999; pointer-events:none; background:var(--accent); color:#fff; padding:4px 8px; border-radius:6px; font-size:12px; box-shadow:0 6px 18px rgba(10,20,20,0.12); opacity:0; transform:translate(-50%, -6px); transition:opacity .15s ease; } /* grid layout to place example box at far right spanning both inputs */ .fields-grid { display:grid; grid-template-columns: 1fr auto; column-gap:28px; row-gap:12px; align-items:start; } .fields-grid .input-col { grid-column:1; } .fields-grid .example-span { grid-column:2; grid-row:1 / span 2; justify-self:end; width:420px; max-width:48vw; } button{ margin-top:8px; padding:10px 14px; border-radius:8px; border:0; background:var(--accent); color:#fff; cursor:pointer; font-weight:700; } button:disabled{opacity:.6;cursor:default} .meta{font-size:13px;color:var(--muted);margin-top:8px} .spinner{display:inline-block;width:12px;height:12px;border-radius:50%;border:2px solid rgba(0,0,0,0.12);border-top-color:var(--accent);animation:spin .8s linear infinite;vertical-align:middle;margin-left:8px} @keyframes spin{to{transform:rotate(360deg)}} /* layout */ .container { display:flex; gap:18px; margin-top:14px; align-items:flex-start; } .left { width:160px; } .left .controls { background: linear-gradient(180deg, #ffffff, #fbfffe); border:1px solid #eef6f4; border-radius:10px; padding:12px; box-shadow:0 6px 18px rgba(10,20,20,0.02); } .icon-btn { display:flex; align-items:center; gap:8px; padding:8px; border-radius:8px; cursor:pointer; margin-bottom:8px; user-select:none; transition:background .12s, color .12s; } .icon-btn:hover { background:rgba(10,168,158,0.06); } .icon-btn.active { background:var(--accent); color:#fff; } .icon-emoji { font-size:20px; width:28px; text-align:center; } .small { font-size:13px; color:#444; } .right { flex:1; min-height:320px; } .panel { border-radius:10px; border:1px solid #eef6f4; padding:14px; margin-bottom:12px; background:var(--card); box-shadow:0 6px 18px rgba(10,20,20,0.03); } .panel h2 { margin:0 0 8px; font-size:15px; display:flex; justify-content:space-between; align-items:center; } .venn-container { width:100%; height:300px; display:flex; align-items:center; justify-content:center; } .stats { font-size:13px; color:#333; margin-top:8px; } #output { white-space:pre-wrap; background:#0f1720; color:#e6eef8; padding:12px; border-radius:8px; margin-top:14px; min-height:140px; overflow:auto; border:1px solid #253046; display:none; } /* table comparison */ .compare-table { width:100%; border-collapse:collapse; margin-top:12px; } .compare-headers { display:flex; gap:12px; } .col { flex:1; border:1px solid #edf7f6; border-radius:8px; padding:10px; min-height:140px; max-height:320px; overflow:auto; background:#fbfffe; } .col h4 { margin:0 0 6px; font-size:13px; color:#0f1720; } .item { font-family:var(--mono); font-size:13px; padding:6px 0; border-bottom:1px dashed rgba(0,0,0,0.04); color:#111; } .hint { font-size:13px; color:var(--muted); margin-top:8px; } /* responsive */ @media (max-width:880px) { .container { flex-direction:column; } .left { width:100%; order:2; } .right { order:1; } .note { max-width:100%; } .site-title { font-size:22px; } .field-row { flex-direction:column; align-items:stretch; } .field-row .input-col { flex:1 1 auto; } .fields-grid { display:block; } } </style> <!-- d3 + venn.js from CDN --> <script src="https://unpkg.com/d3@5"></script> <script src="https://unpkg.com/venn.js@0.2.20/build/venn.min.js"></script> </head> <body> <!-- HERO band with off-white strip --> <div class="hero-band" role="banner" aria-label="BioCompare header"> <div class="hero-left"> <div class="title-wrap"> <h1 class="site-title">BioCompare</h1> <p class="site-tagline">Quickly explore and compare proteins from multiple trusted sources.</p> </div> </div> <div class="note" aria-hidden="false"> <div><strong>Demo sources:</strong> Ensembl, UniProt, and NCBI Gene.</div> <div style="margin-top:6px;color:#334;font-size:13px;"> Some annotations may be incomplete â€” the aggregation pipeline is under active development and will be expanded in upcoming releases. </div> </div> </div> <!-- input area --> <div> <div class="fields-grid"> <div class="input-col"> <label for="ensembl1">Ensembl ID A</label> <input id="ensembl1" type="text" placeholder="ENSG00000141510" /> </div> <div class="example-box example-span" aria-label="Examples"> <div style="font-weight:700; margin-bottom:6px;">Example to see the intersection representation.</div> <div><strong>A</strong>: <span class="copy-id" data-copy="ENSG00000124610">ENSG00000124610</span></div> <div><strong>B</strong>: <span class="copy-id" data-copy="ENSG00000168298">ENSG00000168298</span></div> </div> <div class="input-col"> <label for="ensembl2">Ensembl ID B</label> <input id="ensembl2" type="text" placeholder="ENSG00000139618" /> </div> </div> <div class="meta">This page POSTS the two IDs to your server and uses the returned JSON for frontend comparisons and a comparison table.</div> <button id="submit">Submit</button> <span id="status" class="meta"></span> </div> <div class="container"> <div class="left"> <div class="controls"> <div id="btn-goids" class="icon-btn" title="Compare by GO IDs"> <span class="icon-emoji">ðŸ§¬</span> <div> <div style="font-weight:700">GO IDs</div> <div class="small">Compare by GO identifiers</div> </div> </div> <div id="btn-goterms" class="icon-btn" title="Compare by GO Terms"> <span class="icon-emoji">ðŸ“š</span> <div> <div style="font-weight:700">GO Terms</div> <div class="small">Compare by GO term strings</div> </div> </div> <div id="btn-symbols" class="icon-btn" title="Compare by Gene Symbol"> <span class="icon-emoji">ðŸ”¤</span> <div> <div style="font-weight:700">Gene Symbol</div> <div class="small">Compare by gene symbol (fallback: Ensembl)</div> </div> </div> <div id="btn-raw" class="icon-btn" title="Show raw JSON response"> <span class="icon-emoji">ðŸ“„</span> <div> <div style="font-weight:700">Raw data</div> <div class="small">Toggle raw server JSON</div> </div> </div> <div class="hint">Click an option to open the right panel (A vs B) â€” venn + table.</div> </div> </div> <div class="right"> <!-- GO IDs panel --> <div id="panel-goids" class="panel" style="display:none"> <h2>GO IDs <span id="goids-count"></span></h2> <div id="venn-goids" class="venn-container"></div> <div id="goids-stats" class="stats"></div> <div class="compare-headers" style="margin-top:12px"> <div class="col" id="goids-col-a"><h4>A only</h4><div id="goids-a-list"></div></div> <div class="col" id="goids-col-both"><h4>Shared</h4><div id="goids-both-list"></div></div> <div class="col" id="goids-col-b"><h4>B only</h4><div id="goids-b-list"></div></div> </div> </div> <!-- GO Terms panel --> <div id="panel-goterms" class="panel" style="display:none"> <h2>GO Terms <span id="goterms-count"></span></h2> <div id="venn-goterms" class="venn-container"></div> <div id="goterms-stats" class="stats"></div> <div class="compare-headers" style="margin-top:12px"> <div class="col" id="goterms-col-a"><h4>A only</h4><div id="goterms-a-list"></div></div> <div class="col" id="goterms-col-both"><h4>Shared</h4><div id="goterms-both-list"></div></div> <div class="col" id="goterms-col-b"><h4>B only</h4><div id="goterms-b-list"></div></div> </div> </div> <!-- Symbols panel --> <div id="panel-symbols" class="panel" style="display:none"> <h2>Gene Symbol <span id="symbols-count"></span></h2> <div id="venn-symbols" class="venn-container"></div> <div id="symbols-stats" class="stats"></div> <div class="compare-headers" style="margin-top:12px"> <div class="col" id="symbols-col-a"><h4>A only</h4><div id="symbols-a-list"></div></div> <div class="col" id="symbols-col-both"><h4>Shared</h4><div id="symbols-both-list"></div></div> <div class="col" id="symbols-col-b"><h4>B only</h4><div id="symbols-b-list"></div></div> </div> </div> <!-- Raw JSON output (hidden by default) --> <div id="output">Server response will appear here...</div> </div> </div> <script> /* Endpoint */ const API_ENDPOINT = "http://127.0.0.1:5000/annotate"; /* DOM refs */ const en1 = document.getElementById('ensembl1'); const en2 = document.getElementById('ensembl2'); const btn = document.getElementById('submit'); const out = document.getElementById('output'); const status = document.getElementById('status'); const btnGoIds = document.getElementById('btn-goids'); const btnGoTerms = document.getElementById('btn-goterms'); const btnSymbols = document.getElementById('btn-symbols'); const btnRaw = document.getElementById('btn-raw'); const panelGoIds = document.getElementById('panel-goids'); const panelGoTerms = document.getElementById('panel-goterms'); const panelSymbols = document.getElementById('panel-symbols'); const goidsAList = document.getElementById('goids-a-list'); const goidsBothList = document.getElementById('goids-both-list'); const goidsBList = document.getElementById('goids-b-list'); const gotermsAList = document.getElementById('goterms-a-list'); const gotermsBothList = document.getElementById('goterms-both-list'); const gotermsBList = document.getElementById('goterms-b-list'); const symbolsAList = document.getElementById('symbols-a-list'); const symbolsBothList = document.getElementById('symbols-both-list'); const symbolsBList = document.getElementById('symbols-b-list'); const goidsCount = document.getElementById('goids-count'); const gotermsCount = document.getElementById('goterms-count'); const symbolsCount = document.getElementById('symbols-count'); const goidsStats = document.getElementById('goids-stats'); const gotermsStats = document.getElementById('goterms-stats'); const symbolsStats = document.getElementById('symbols-stats'); let lastResponse = null; /* small helpers */ function setBusy(b, msg) { btn.disabled = b; status.textContent = msg || ""; const existing = document.querySelector('.spinner'); if (b && !existing) { const s = document.createElement('span'); s.className = 'spinner'; status.appendChild(s); } else if (!b && existing) existing.remove(); } function tryPretty(text) { try { return JSON.stringify(JSON.parse(text), null, 2); } catch(e) { return text; } } async function postJSON(body){ return fetch(API_ENDPOINT, { method: 'POST', headers: {'Content-Type': 'application/json', 'Accept': '*/*'}, body: JSON.stringify(body) }); } async function getFallback(params){ const url = new URL(API_ENDPOINT); Object.keys(params).forEach(k => url.searchParams.set(k, params[k] || '')); return fetch(url.toString(), {method:'GET', headers:{'Accept':'*/*'}}); } function normalizeString(x) { if (x === null || x === undefined) return ""; return String(x).trim(); } function normalizeGOId(x) { return normalizeString(x).toUpperCase(); } function normalizeGOTerm(x) { return normalizeString(x); } function normalizeSymbol(x) { return normalizeString(x); } function buildSets(resp, axis) { if (!resp || !resp.annotations || resp.annotations.length < 2) return null; const a0 = resp.annotations[0], a1 = resp.annotations[1]; if (axis === 'go_ids') { const arrA = Array.isArray(a0.go_ids) ? a0.go_ids.map(normalizeGOId).filter(Boolean) : []; const arrB = Array.isArray(a1.go_ids) ? a1.go_ids.map(normalizeGOId).filter(Boolean) : []; return { arrA, arrB, setA: new Set(arrA), setB: new Set(arrB) }; } else if (axis === 'go_terms') { const arrA = Array.isArray(a0.go_terms) ? a0.go_terms.map(normalizeGOTerm).filter(Boolean) : []; const arrB = Array.isArray(a1.go_terms) ? a1.go_terms.map(normalizeGOTerm).filter(Boolean) : []; return { arrA, arrB, setA: new Set(arrA), setB: new Set(arrB) }; } else if (axis === 'symbol') { const valA = (a0.gene_symbol && a0.gene_symbol.trim()) ? a0.gene_symbol.trim() : a0.ensembl_id; const valB = (a1.gene_symbol && a1.gene_symbol.trim()) ? a1.gene_symbol.trim() : a1.ensembl_id; return { arrA: [normalizeSymbol(valA)], arrB: [normalizeSymbol(valB)], setA: new Set([valA]), setB: new Set([valB]) }; } return null; } function setIntersection(A,B){ const out=new Set(); for(const x of A) if(B.has(x)) out.add(x); return out; } function setDifference(A,B){ const out=new Set(); for(const x of A) if(!B.has(x)) out.add(x); return out; } function unionSorted(A,B){ return Array.from(new Set([...A,...B])).sort(); } function drawVenn(containerId, setA, setB, labelA, labelB, statsEl, countSpan) { const container = d3.select("#" + containerId); container.selectAll("*").remove(); const inter = setIntersection(setA, setB); const data = [ { sets: [0], size: setA.size, label: labelA }, { sets: [1], size: setB.size, label: labelB }, { sets: [0,1], size: inter.size, label: labelA + " âˆ© " + labelB } ]; try { venn.VennDiagram().width(container.node().clientWidth).height(container.node().clientHeight)(container.datum(data), data); } catch(e) { container.selectAll("*").remove(); } const onlyA = setDifference(setA, setB).size; const onlyB = setDifference(setB, setA).size; const unionSize = unionSorted(setA, setB).length; statsEl.innerHTML = <strong>${labelA} only:</strong> ${onlyA} &nbsp;&nbsp; <strong>Intersection:</strong> ${inter.size} &nbsp;&nbsp; <strong>${labelB} only:</strong> ${onlyB} <br><strong>Union (unique):</strong> ${unionSize}; if (countSpan) countSpan.textContent = (${setA.size} , ${setB.size}); return { onlyA: Array.from(setDifference(setA, setB)).sort(), onlyB: Array.from(setDifference(setB, setA)).sort(), shared: Array.from(inter).sort() }; } function renderColumnList(containerEl, items) { containerEl.innerHTML = ''; if (!items || items.length === 0) { containerEl.innerHTML = '<div class="item" style="color:#888">â€”</div>'; return; } for (const it of items) { const d = document.createElement('div'); d.className='item'; d.textContent = it; containerEl.appendChild(d); } } function collapseAll() { panelGoIds.style.display='none'; panelGoTerms.style.display='none'; panelSymbols.style.display='none'; out.style.display='none'; [btnGoIds,btnGoTerms,btnSymbols,btnRaw].forEach(b=>b.classList.remove('active')); } function showPanel(axis){ if(!lastResponse){ alert('No server response stored yet. Click Submit.'); return; } if(!lastResponse.annotations || lastResponse.annotations.length < 2){ alert('Server response must contain exactly two annotations (A and B).'); return; } collapseAll(); if(axis==='go_ids'){ btnGoIds.classList.add('active'); panelGoIds.style.display='block'; const { setA,setB } = buildSets(lastResponse,'go_ids'); const res = drawVenn('venn-goids', setA, setB, 'A','B', goidsStats, goidsCount); renderColumnList(goidsAList,res.onlyA); renderColumnList(goidsBothList,res.shared); renderColumnList(goidsBList,res.onlyB); } else if(axis==='go_terms'){ btnGoTerms.classList.add('active'); panelGoTerms.style.display='block'; const { setA,setB } = buildSets(lastResponse,'go_terms'); const res = drawVenn('venn-goterms', setA, setB, 'A','B', gotermsStats, gotermsCount); renderColumnList(gotermsAList,res.onlyA); renderColumnList(gotermsBothList,res.shared); renderColumnList(gotermsBList,res.onlyB); } else if(axis==='symbol'){ btnSymbols.classList.add('active'); panelSymbols.style.display='block'; const { setA,setB } = buildSets(lastResponse,'symbol'); const res = drawVenn('venn-symbols', setA, setB, 'A','B', symbolsStats, symbolsCount); renderColumnList(symbolsAList,res.onlyA); renderColumnList(symbolsBothList,res.shared); renderColumnList(symbolsBList,res.onlyB); } else if(axis==='raw'){ btnRaw.classList.add('active'); out.style.display = (out.style.display === 'block') ? 'none' : 'block'; } } /* listeners */ btnGoIds.addEventListener('click', ()=> showPanel('go_ids')); btnGoTerms.addEventListener('click', ()=> showPanel('go_terms')); btnSymbols.addEventListener('click', ()=> showPanel('symbol')); btnRaw.addEventListener('click', ()=> { collapseAll(); btnRaw.classList.add('active'); out.style.display = (out.style.display === 'block') ? 'none' : 'block'; }); btn.addEventListener('click', async ()=> { out.textContent=''; collapseAll(); const id1 = en1.value.trim(), id2 = en2.value.trim(); if(!id1 && !id2){ out.textContent='Enter at least one Ensembl ID.'; return; } setBusy(true,'Sending request...'); let resp = null; try { resp = await postJSON({ id1: id1 || null, id2: id2 || null }); } catch(e){ resp = null; } if(!resp || (resp.status >= 400 && resp.status !== 400)){ setBusy(true,'POST failed â€” trying GET fallback...'); try { resp = await getFallback({ id1, id2 }); } catch(e){ resp = null; } } if(!resp){ out.textContent='Request failed (network/CORS). Make sure server is running at http://127.0.0.1:5000'; setBusy(false,'Error'); return; } const text = await resp.text(); let parsed = null; try { parsed = JSON.parse(text); } catch(e) { parsed = null; } lastResponse = parsed || { raw:text }; out.textContent = tryPretty(text); setBusy(false, HTTP ${resp.status} ${resp.statusText}); }); // click-to-copy for example IDs document.addEventListener('click', function(e){ const target = e.target; if (target && target.classList && target.classList.contains('copy-id')) { const value = target.getAttribute('data-copy') || target.textContent; if (!value) return; navigator.clipboard.writeText(value).then(()=>{ target.classList.add('copied'); target.textContent = value; // tooltip const tip = document.createElement('div'); tip.className = 'tooltip-copied'; tip.textContent = 'Copied'; document.body.appendChild(tip); const rect = target.getBoundingClientRect(); tip.style.left = (rect.left + rect.width/2) + 'px'; tip.style.top = (rect.top - 10) + 'px'; requestAnimationFrame(()=>{ tip.style.opacity = '1'; }); setTimeout(()=>{ tip.style.opacity = '0'; setTimeout(()=> tip.remove(), 200); }, 800); setTimeout(()=> target.classList.remove('copied'), 900); }).catch(()=>{}); } }); </script> <pre id="example-ids" aria-hidden="true" style="position:absolute;left:-10000px;top:auto;width:1px;height:1px;overflow:hidden;white-space:pre;"> A: ENSG00000124610 B: ENSG00000168298 Example to see the intersection representation. </pre> </body> </html>
